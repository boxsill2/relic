<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title><%= year %> 시즌 F1 그랑프리 일정</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="/css/base.css?v=f1" />
  <link rel="stylesheet" href="/css/header-style.css?v=f1" />
  <link rel="stylesheet" href="/css/schedule-style.css?v=f1" />
</head>
<body>
  <%- include('partials/header', { currentPage: 'schedule' }) %>

  <main class="container">
    <div class="title-header">
        <h1><%= year %> 시즌 그랑프리</h1>
        <p>복습하고 싶은 경기의 리플레이를 확인해 보세요.</p>
    </div>

    <% if (error) { %>
      <p><%= error %></p>
    <% } else if (!schedule || schedule.length === 0) { %>
      <p>스케줄 데이터를 찾을 수 없습니다. `python f1_get_gp_list.py`를 실행했는지 확인해 주세요.</p>
    <% } else { %>
      <div class="schedule-grid">
        <% schedule.forEach(gp => { %>
          <%
            const startDate = new Date(gp.date_start);
            let dateString = !isNaN(startDate) ? startDate.toLocaleDateString("ko-KR", { month: 'long', day: 'numeric', weekday: 'long' }) : "날짜 정보 없음";
            let timeString = !isNaN(startDate) ? startDate.toLocaleTimeString("ko-KR", { hour: 'numeric', minute: 'numeric', hour12: true }) : "";
          %>
          <div class="race-card">
            <div class="race-info">
              <span class="round"><%= gp.circuit_short_name || 'TBA' %></span>
              <h2><%= gp.meeting_name || gp.country_name %></h2>
              <p class="date"><%= dateString %> · <%= timeString %></p>
            </div>
            
            <%# 모든 버튼이 항상 활성화되도록 수정된 부분 %>
            <a href="/replays/<%= gp.session_key %>" class="replay-link">리플레이 보기</a>
          </div>
        <% }) %>
      </div>
    <% } %>
  </main>
</body>
</html>