<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title><%= driver?.korean_name || driver?.full_name || 'Driver' %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/base.css?v=f1" />
  <link rel="stylesheet" href="/css/header-style.css?v=f1" />
  <link rel="stylesheet" href="/css/driver-style.css?v=f1" />
  <style>
    .driver-description {
      opacity: 0.9;
      line-height: 1.6;
      margin: 12px 0;
      font-size: 14px;
      white-space: pre-wrap; /* \n 줄바꿈 적용 */
    }
  </style>
</head>
<body class="theme-f1 driver-detail-page">
  <%# include('partials/header', { currentPage:'drivers' }) %> <%# 헤더는 계속 주석 처리 상태 유지 (나중에 필요시 해제) %>

  <main class="container">
    <section class="page-header">
      <h1 class="page-title"><%= driver?.korean_name || driver?.full_name || 'Driver' %></h1>
    </section>

    <% if (error) { %>
      <p class="page-desc" style="opacity:.85"><%= error %></p>
    <% } %>

    <% if (driver) { %>
      <section class="driver-hero">
        <div class="driver-photo driver-photo--full">
          <% if (driver.photo_src) { %>
            <img src="<%= driver.photo_src %>" alt="<%= driver.full_name %>"
                 loading="lazy" decoding="async"
                 onerror="this.remove()" />
          <% } else { %>
            <div class="avatar-fallback"><%= driver.full_name?.split(' ').map(n => n[0]).join('') %></div>
          <% } %>
        </div>

        <div>
          <h2 class="driver-name"><%= driver.korean_name || driver.full_name %></h2>
          <p class="driver-team">
            <% if (driver.team_logo) { %>
              <img class="team-logo" src="<%= driver.team_logo %>" alt="<%= driver.team_name %>"
                   style="width: 20px; height: 20px; vertical-align: middle; margin-right: 5px; border-radius: 4px;"
                   onerror="this.style.display='none'">
            <% } %>
            <%= driver.team_name || '팀 정보 없음' %>
            <% if (driver.number) { %> · 등번호 <strong>#<%= driver.number %></strong><% } %>
          </p>

          <% if (driver.description && driver.description !== "설명 없음") { %>
            <p class="driver-description"><%= driver.description %></p>
          <% } %>
        </div>
      </section>

      <%# --- >>> 스탯 섹션 시작 (주석 해제됨) <<< --- %>
      <% if (driver.stats && (driver.stats.season || driver.stats.career)) { %> <%# stats 데이터가 있는지 확인 %>
      <section class="stats-wrap">
        <% if (driver.stats.season) { %> <%# 시즌 데이터가 있을 때만 표시 %>
        <article class="stats-card">
          <h3><%= new Date().getFullYear() %> 시즌</h3>
          <ul class="stat-list">
            <li class="stat-row"><span class="k">시즌 순위</span><span class="v"><%= driver.stats.season?.season_position ?? '-' %></span></li>
            <li class="stat-row"><span class="k">시즌 포인트</span><span class="v"><%= driver.stats.season?.season_points ?? 0 %></span></li>
            <li class="stat-row"><span class="k">그랑프리 출전</span><span class="v"><%= driver.stats.season?.gp_races ?? 0 %></span></li>
            <li class="stat-row"><span class="k">그랑프리 포인트</span><span class="v"><%= driver.stats.season?.gp_points ?? 0 %></span></li>
            <li class="stat-row"><span class="k">그랑프리 포디움</span><span class="v"><%= driver.stats.season?.gp_podiums ?? 0 %></span></li>
            <li class="stat-row"><span class="k">그랑프리 TOP 10</span><span class="v"><%= driver.stats.season?.gp_top10 ?? 0 %></span></li>
            <li class="stat-row"><span class="k">리타이어(DNF)</span><span class="v"><%= driver.stats.season?.dnfs ?? 0 %></span></li>
          </ul>
        </article>
        <% } %>

        <% if (driver.stats.career) { %> <%# 커리어 데이터가 있을 때만 표시 %>
        <article class="stats-card">
          <h3>커리어 통계</h3>
          <ul class="stat-list">
            <li class="stat-row"><span class="k">통산 출전 (GP)</span><span class="v"><%= driver.stats.career?.gp_entered ?? 0 %></span></li>
            <li class="stat-row"><span class="k">통산 포인트</span><span class="v"><%= driver.stats.career?.career_points ?? 0 %></span></li>
            <li class="stat-row"><span class="k">최고 결승 순위</span><span class="v"><%= driver.stats.career?.best_finish ?? '-' %></span></li>
            <li class="stat-row"><span class="k">포디움</span><span class="v"><%= driver.stats.career?.podiums ?? 0 %></span></li>
            <li class="stat-row"><span class="k">최고 그리드</span><span class="v"><%= driver.stats.career?.best_grid ?? '-' %></span></li>
            <li class="stat-row"><span class="k">폴 포지션</span><span class="v"><%= driver.stats.career?.poles ?? 0 %></span></li>
            <li class="stat-row"><span class="k">월드 챔피언</span><span class="v"><%= driver.stats.career?.titles ?? 0 %></span></li>
            <li class="stat-row"><span class="k">DNFs</span><span class="v"><%= driver.stats.career?.dnfs ?? 0 %></span></li>
          </ul>
        </article>
        <% } %>
      </section>
      <% } %>
      <%# --- >>> 스탯 섹션 끝 (주석 해제됨) <<< --- %>

    <% } %> <%# if (driver) 끝 %>
  </main>
</body>
</html>